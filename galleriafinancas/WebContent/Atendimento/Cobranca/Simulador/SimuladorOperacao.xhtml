<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:shiro="http://shiro.apache.org/tags"
	xmlns:p="http://primefaces.org/ui"
	template="../../MenuAtendimento.xhtml">

	<ui:define name="conteudo">

		<h:outputStylesheet>
			.row { 
				width:100%
			}
			.columns { 
				width:20%;
				max-width:20%;
				text-align:center;
			}	
			.parametrosLabel { 
				width:110px
			}
			.parametrosValor { 
				width:200px
			}  
			.padRight20{
				padding-right: 20px;
			}
			.labelInfo{
				white-space: nowrap;
    			font-size: 11px!important;
			}
   		</h:outputStylesheet>

		<h:form id="form" style="margin-bottom:10px;">

			<script src="#{request.contextPath}/resources/js/functions.js"></script>
			<script
				src="#{request.contextPath}/resources/js/locale-primefaces.js"></script>

			<p:messages id="mensagens" showDetail="true" />

			<p:panel id="DemonstrativoResultados" header="Simular Operação"
				style="margin-bottom:10px;">
				<h:panelGrid columns="2" columnClasses="padRight20">
					<h:panelGrid columns="2"
						columnClasses="parametrosLabel, parametrosValor">
						<p:outputLabel for="TipoCalculoFinal" value="Tipo Cálculo: "
							styleClass="labelBold" style="margin-right: 59px;white-space: nowrap;" />
						<p:selectOneRadio id="TipoCalculoFinal"
							value="#{simuladorMB.tipoCalculoFinal}">
							<f:selectItem itemLabel="Liquido" itemValue="L" />
							<f:selectItem itemLabel="Bruto" itemValue="B" />
						</p:selectOneRadio>
						 
						<p:outputLabel for="valorImovel" value="Valor Imóvel: "
							styleClass="labelBold" />
						<p:inputText id="valorImovel" value="#{simuladorMB.valorImovel}"
							onkeypress="return isNumberKey(event);"
							onkeydown="FormataValor(this, 13, event, 2);" required="true"
							converter="bigDecimalConverter">
						</p:inputText>
						<p:outputLabel for="valorCredito" value="Valor Crédito: "
							styleClass="labelBold" />
						<p:inputText id="valorCredito" value="#{simuladorMB.valorCredito}"
							onkeypress="return isNumberKey(event);"
							onkeydown="FormataValor(this, 13, event, 2);" required="true"
							converter="bigDecimalConverter">
						</p:inputText>

						<p:outputLabel for="taxaJuros" value="Taxa Juros: "
							styleClass="labelBold" />
						<h:panelGrid columns="2">
							<p:inputText id="taxaJuros" value="#{simuladorMB.taxaJuros}"
								onkeypress="return isNumberKey(event);"
								onkeydown="FormataValor(this, 3, event, 2);" required="true"
								converter="bigDecimalConverter">
							</p:inputText>
							<p:outputLabel value="%" styleClass="labelBold" />
							<h:panelGroup class="labelInfo"
								rendered="#{simuladorMB.tipoCalculo ne 'Americano'}">
								Valor mínimo de 1,19%
							</h:panelGroup>
							<h:panelGroup class="labelInfo"
								rendered="#{simuladorMB.tipoCalculo eq 'Americano'}">
								Valor mínimo de 1,99%
							</h:panelGroup>
						</h:panelGrid>

						<p:outputLabel for="prazo" value="Qtd parcelas: "
							styleClass="labelBold" />
						<h:panelGrid columns="2">
							<p:inputText id="prazo" value="#{simuladorMB.parcelas}"
								onkeypress="return isNumberKey(event);" required="true"
								maxlength="3">
							</p:inputText>
							<p:outputLabel value="meses" styleClass="labelBold" />
							<h:panelGroup class="labelInfo"
								rendered="#{simuladorMB.tipoCalculo ne 'Americano'}">
							Valor máximo de 240 meses
							</h:panelGroup>
							<h:panelGroup class="labelInfo"
								rendered="#{simuladorMB.tipoCalculo eq 'Americano'}">
							Valor máximo de 36 meses
							</h:panelGroup>
						</h:panelGrid>

						<p:outputLabel for="carencia" value="Carência: "
							styleClass="labelBold" />
						<p:selectOneMenu id="carencia" value="#{simuladorMB.carencia}"
							required="true" style="width: 50px;">
							<f:selectItem itemLabel="0" itemValue="0" />
							<f:selectItem itemLabel="1" itemValue="1" />
							<f:selectItem itemLabel="2" itemValue="2" />
							<f:selectItem itemLabel="3" itemValue="3" />
						</p:selectOneMenu>
					</h:panelGrid>
					<h:panelGrid columns="2"
						columnClasses="parametrosLabel, parametrosValor">
						<p:outputLabel for="tipoPessoa" value="Tipo Pessoa: "
							styleClass="labelBold" />
						<p:selectOneMenu id="tipoPessoa" value="#{simuladorMB.tipoPessoa}"
							required="true" style="width: 100px;">
							<f:selectItem itemValue="PF" itemLabel="Pessoa Física" />
							<f:selectItem itemValue="PJ" itemLabel="Pessoa Jurídica" />
						</p:selectOneMenu>
						<p:outputLabel for="tipoCalculo" value="Tipo Cálculo: "
							styleClass="labelBold" />
						<p:selectOneMenu id="tipoCalculo"
							value="#{simuladorMB.tipoCalculo}" required="true"
							style="width: 80px;">
							<f:selectItem itemValue="Price" itemLabel="Price" />
							<f:selectItem itemValue="SAC" itemLabel="SAC" />
							<f:selectItem itemValue="Americano" itemLabel="Americano" />
							<p:ajax event="change" process="@form"
								update="DemonstrativoResultados" />
						</p:selectOneMenu>
						
						<shiro:hasAnyRoles name="ROOT, COMITECONSULTAR">					
							<p:outputLabel for="simularComIPCA" value="Simular com IPCA: "
								styleClass="labelBold" />
							<p:selectBooleanCheckbox id="simularComIPCA" 
								value="#{simuladorMB.simularComIPCA}"  style="margin-left: 12px;">
								<p:ajax update="ipcaSimulado ipcaSimuladoTexto" event="change" />
							</p:selectBooleanCheckbox>
							<h:panelGroup id="ipcaSimuladoTexto" >
								<p:outputLabel for="ipcaSimulado" value="IPCA: "
									styleClass="labelBold" rendered="#{simuladorMB.simularComIPCA}" />
							</h:panelGroup>
							<h:panelGrid id="ipcaSimulado" columns="2" >
								<p:inputText rendered="#{simuladorMB.simularComIPCA}" value="#{simuladorMB.ipcaSimulado}"
									onkeypress="return isNumberKey(event);"
									onkeydown="FormataValor(this, 3, event, 2);" required="true"
									converter="bigDecimalConverter">
								</p:inputText>
								<p:outputLabel value="%" rendered="#{simuladorMB.simularComIPCA}"  styleClass="labelBold" />
							</h:panelGrid>					
						
							<p:outputLabel for="usarNovoCustoEmissao" value="Usar Novo Custo Emissão: "
								styleClass="labelBold" />
							<p:selectBooleanCheckbox id="usarNovoCustoEmissao" 
								value="#{simuladorMB.usarNovoCustoEmissao}"  style="margin-left: 12px;">
							</p:selectBooleanCheckbox>
						</shiro:hasAnyRoles>
						
					</h:panelGrid>
				</h:panelGrid>

				<h:panelGrid columns="2">
					<p:commandButton value="Simular" action="#{simuladorMB.simular}"
						icon="ui-icon ui-icon-check"
						update=":form:ConsultaResultados mensagens"
						style="TEXT-DECORATION: bold;" />
				</h:panelGrid>


			</p:panel>

			<p:panel id="ConsultaResultados" header="Simulação"
				style="margin-bottom:10px;">

				<ui:include
					src="/Atendimento/Cobranca/Simulador/SimuladorParcelas.xhtml">
					<ui:param name="simulador" value="true"></ui:param>
					<ui:param name="simulacao" value="#{simuladorMB.simulacao}"></ui:param>
				</ui:include>

			</p:panel>
		</h:form>

	</ui:define>
</ui:composition>