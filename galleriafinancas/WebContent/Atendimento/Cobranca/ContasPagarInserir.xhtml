<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:shiro="http://shiro.apache.org/tags"
	xmlns:p="http://primefaces.org/ui" template="../MenuAtendimento.xhtml">

	<ui:define name="conteudo">
		<h:form id="form" style="margin-bottom:10px;">
			<script src="#{request.contextPath}/resources/js/functions.js"></script>
			<script src="#{request.contextPath}/resources/js/locale-primefaces.js" library="javascript"></script>
			<p:messages id="mensagens" showDetail="true" />
			<p:panel id="contasPagar" header="Contas a Pagar"
				style="margin-bottom:20px;">
				<h:panelGrid columns="2">
					<p:outputLabel value="Tipo Despesa: " styleClass="labelBold"
						style="margin-right: 59px;" />

					<h:outputText id="TipoDespesaC" value="Contrato "
						rendered="#{contasPagarMB.objetoContasPagar.tipoDespesa eq 'C'}" />

					<h:outputText id="TipoDespesaE" value="Empresa"
						rendered="#{contasPagarMB.objetoContasPagar.tipoDespesa eq 'E'}" />

					<p:outputLabel for="numcontrato" value="Contrato: "
						rendered="#{contasPagarMB.objetoContasPagar.tipoDespesa eq 'C'}"
						styleClass="labelBold" />
					<h:panelGrid columns="2"
						rendered="#{contasPagarMB.objetoContasPagar.tipoDespesa eq 'C'}">
						<p:inputText id="numcontrato"
							value="#{contasPagarMB.objetoContasPagar.numeroDocumento}"
							label="Contrato" style="width:110px;"
							disabled="#{contasPagarMB.baixaMode}" />
					</h:panelGrid>

					<p:outputLabel for="pagadorRecebedor" value="Recebedor: "
						rendered="#{contasPagarMB.objetoContasPagar.tipoDespesa eq 'E'}"
						styleClass="labelBold" />
					<h:panelGrid columns="2" id="pagadorPanel"
						rendered="#{contasPagarMB.objetoContasPagar.tipoDespesa eq 'E'}">
						<p:inputText id="pagadorRecebedor"
							value="#{contasPagarMB.objetoContasPagar.pagadorRecebedor.nome}"
							label="Recebedor" style="width:210px;" disabled="true" />

						<p:commandButton ajax="true" 
							action="#{contasPagarMB.pesquisaPagador}"							
							icon="ui-icon ui-icon-circle-zoomin"  process="@this" 
							oncomplete="PF('pagadorRecebedorDialog').show();"
							update="formReceborPagador">
						</p:commandButton>
										
					</h:panelGrid>
					
					<p:outputLabel for="responsavel" value="Responsável: "
						rendered="#{contasPagarMB.objetoContasPagar.tipoDespesa eq 'E'}"
						styleClass="labelBold" />
					<h:panelGrid columns="2"
						rendered="#{contasPagarMB.objetoContasPagar.tipoDespesa eq 'E'}">
							<p:inputText id="responsavel"
								value="#{contasPagarMB.objetoContasPagar.responsavel.nome}"
								label="Responsável" disabled="true" 
								style="width:210px;" />
							<p:commandButton id="botaoResponsavel" type="button"
								onclick="PF('responsavelDialog').show();"
								image="ui-icon ui-icon-circle-zoomin"  />

					</h:panelGrid>
					
					<p:outputLabel for="contaContabil" value="Conta Contábil: "
						rendered="#{contasPagarMB.objetoContasPagar.tipoDespesa eq 'E'}"
						styleClass="labelBold" />
					<h:panelGrid columns="2"
						rendered="#{contasPagarMB.objetoContasPagar.tipoDespesa eq 'E'}">
						<p:inputText id="contaContabil"
							value="#{contasPagarMB.objetoContasPagar.contaContabil.nome}"
							label="Conta Contábil" style="width:210px;" disabled="true" />

						<p:commandButton id="botaoContaContabil" type="button"
							onclick="PF('contaContabilDialog').show();"
							image="ui-icon ui-icon-circle-zoomin" />
					</h:panelGrid>

					<p:outputLabel for="dataPrevista" value="Data Prevista Pagamento: "
						rendered="#{contasPagarMB.objetoContasPagar.tipoDespesa eq 'C'}"
						styleClass="labelBold" />
					<p:calendar id="dataPrevista"
						value="#{contasPagarMB.objetoContasPagar.dataVencimento}"
						rendered="#{contasPagarMB.objetoContasPagar.tipoDespesa eq 'C'}"
						required="true" label="Data" size="100" pattern="dd/MM/yyyy"
						styleClass="dateTimeField" disabled="#{contasPagarMB.baixaMode}">
					</p:calendar>

					<p:outputLabel for="dataVencimento" value="Data Vencimento: "
						styleClass="labelBold" />
					<p:calendar id="dataVencimento"
						value="#{contasPagarMB.objetoContasPagar.dataVencimento}"
						required="true" label="Data" size="100" pattern="dd/MM/yyyy"
						styleClass="dateTimeField" disabled="#{contasPagarMB.baixaMode}">
						<p:ajax event="dateSelect" update="dataPagamento"
							listener="#{contasPagarMB.settarDataPagamento()}" />
					</p:calendar>

					<p:outputLabel for="numeroDocumento" value=" Numero Documento: "
						styleClass="labelBold" />
					<p:inputText id="numeroDocumento"
						value="#{contasPagarMB.objetoContasPagar.numeroDocumento}"
						disabled="#{contasPagarMB.baixaMode}" />

					<p:outputLabel for="descricao" value="Descrição: "
						styleClass="labelBold" />
					<p:inputText id="descricao"
						value="#{contasPagarMB.objetoContasPagar.descricao}"
						disabled="#{contasPagarMB.baixaMode}" />
					<p:outputLabel for="valor" value="Valor (R$): "
						styleClass="labelBold" />
					<p:inputText id="valor"
						value="#{contasPagarMB.objetoContasPagar.valor}"
						onkeypress="return isNumberKey(event);"
						onkeydown="FormataValor(this, 13, event, 2);" required="true"
						converter="bigDecimalConverter"
						disabled="#{contasPagarMB.baixaMode}" >
						<p:ajax event="blur" update="valorPagamento"
							listener="#{contasPagarMB.settarValorPagamento()}" />
					</p:inputText>

					<p:outputLabel for="valorPagamento" value="Valor Pagamento (R$): "

						styleClass="labelBold" />
					<p:inputText id="valorPagamento"
						value="#{contasPagarMB.objetoContasPagar.valorPagamento}"
						onkeypress="return isNumberKey(event);"
						onkeydown="FormataValor(this, 13, event, 2);" required="false"
						converter="bigDecimalConverter"
						disabled="#{contasPagarMB.deleteMode or !contasPagarMB.baixaMode}" />
						
					<p:outputLabel for="dataPagamento" value="Data Pagamento: "
						styleClass="labelBold" />
					<p:calendar id="dataPagamento"
						value="#{contasPagarMB.objetoContasPagar.dataPagamento}"
						label="Data" size="100" pattern="dd/MM/yyyy"
						styleClass="dateTimeField" disabled="#{contasPagarMB.deleteMode or !contasPagarMB.baixaMode}">
					</p:calendar>

				</h:panelGrid>
			</p:panel>
			<p:commandButton value="Salvar Conta" ajax="false"
				icon="ui-icon-print" action="#{contasPagarMB.salvarConta}"
				rendered="#{!contasPagarMB.deleteMode}" />
			<p:spacer height="10" rendered="#{!contasPagarMB.deleteMode}" />
			<p:commandButton value="Baixar Conta" ajax="false"
				icon="ui-icon-arrowthickstop-1-s"
				action="#{contasPagarMB.baixarConta}"
				rendered="#{!contasPagarMB.deleteMode}" />
			<p:commandButton value="Excluir Conta" ajax="false"
				icon="ui-icon-print" action="#{contasPagarMB.excluirConta}"
				rendered="#{contasPagarMB.deleteMode}" />
			<p:spacer height="10" />
			<p:commandButton value="Cancelar" ajax="false" immediate="true"
				icon="ui-icon-cancel" action="#{contasPagarMB.clearFields}"
				style="TEXT-DECORATION: bold; " />
		</h:form>
		<p:dialog header="Contratos" widgetVar="contratoDialog"
			resizable="false" style="FONT-SIZE: 10pt;" width="600">
			<h:form id="formContratos">
				<p:dataTable id="contratoDialogdlg" var="contratoDialogdlg"
					value="#{contasPagarMB.listContratos}" paginator="true" rows="10"
					selectionMode="single"
					paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
					rowsPerPageTemplate="5, 10, 15"
					selection="#{contasPagarMB.selectedContratoLov}"
					style="FONT-SIZE: 10pt;" emptyMessage=""
					rowKey="#{contratoDialogdlg.id}">

					<p:column style="text-align: center;"
						sortBy="#{contratoDialogdlg.numeroContrato}"
						filterBy="#{contratoDialogdlg.numeroContrato}"
						filterMatchMode="contains">
						<f:facet name="header">
							<h:outputText value="Contrato" />
						</f:facet>
						<h:outputText value="#{contratoDialogdlg.numeroContrato}" />
					</p:column>

					<p:column style="text-align: center;"
						sortBy="#{contratoDialogdlg.pagador.nome}"
						filterBy="#{contratoDialogdlg.pagador.nome}"
						filterMatchMode="contains">
						<f:facet name="header">
							<h:outputText value="Pagador" />
						</f:facet>
						<h:outputText value="#{contratoDialogdlg.pagador.nome}" />
					</p:column>

					<f:facet name="footer">
						<p:commandButton value="Selecionar"
							action="#{contasPagarMB.populateSelectedContrato}"
							image="ui-icon ui-icon-check" update=":form:contasPagar"
							oncomplete="PF('contratoDialog').hide();" />
						<p:commandButton value="Limpar Seleção"
							action="#{contasPagarMB.clearContrato}"
							image="ui-icon ui-icon-trash"
							update=":form:contasPagar contratoDialogdlg"
							oncomplete="PF('contratoDialog').hide();" />
						<p:commandButton value="Cancelar" image="ui-icon ui-icon-cancel"
							oncomplete="PF('contratoDialog').hide();" />
					</f:facet>
				</p:dataTable>
			</h:form>
		</p:dialog>

		<ui:include src="../../Dialog/DialogRecebedorPagador.xhtml">
			<ui:param name="mbean" value="#{contasPagarMB}"></ui:param>
			<ui:param name="titulo" value="Recebedor"></ui:param>
		</ui:include>

		<ui:include src="../../Dialog/DialogResponsavel.xhtml">
			<ui:param name="mbean" value="#{contasPagarMB}"></ui:param>
			<ui:param name="titulo" value="Responsavel"></ui:param>
		</ui:include>

		<ui:include src="../../Dialog/DialogContaContabil.xhtml">
			<ui:param name="mbean" value="#{contasPagarMB}"></ui:param>
		</ui:include>
	</ui:define>
</ui:composition>
