<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:shiro="http://shiro.apache.org/tags"
	xmlns:p="http://primefaces.org/ui" template="/Menus/Menu.xhtml">

	<ui:define name="conteudo">
		<h:form id="form" style="margin-bottom:10px;">
			<script src="#{request.contextPath}/resources/js/functions.js"></script>
			<script src="#{request.contextPath}/resources/js/locale-primefaces.js" library="javascript"></script>
			<script type="text/javascript"
					src="/banking/faces/javax.faces.resource/jquery/jquery-plugins.js?ln=primefaces&amp;v=4.0"></script>
			<link type="text/css" rel="stylesheet"
					href="/banking/faces/javax.faces.resource/primefaces.css?ln=primefaces&amp;v=4.0" />
			<p:messages id="mensagens" showDetail="true" />
						<p:panel id="PanelPDF" header="Impressão em PDF"
				style="margin-bottom:10px;" rendered="#{impressoesPDFMB.pdfCadastroPessoaFisicaGerado}">
				<p:focus />
				
				
				<p:messages />
				<h:panelGrid columns="2">
					<p:dialog modal="true" widgetVar="statusDialog" header="Status"
						draggable="false" closable="false" resizable="false">
						<p:graphicImage name="image/ajaxloadingbar.gif" />
					</p:dialog>

					<h:form>
						<p:commandButton value="Ficha Principal" ajax="false"
							
							icon="ui-icon-arrowthick-1-s">
							<p:fileDownload value="#{impressoesPDFMB.file}" />
						</p:commandButton>
						<p:commandButton value="Ficha Conjuge" ajax="false"
							
							icon="ui-icon-arrowthick-1-s">
							<p:fileDownload value="#{impressoesPDFMB.fileConjuge}" />
						</p:commandButton>
					</h:form>

					<script type="text/javascript">
						function start() {
							PF('statusDialog').show();
						}

						function stop() {
							PF('statusDialog').hide();
						}
					</script>

				</h:panelGrid>
			</p:panel>
			<p:panel id="ConsultaContratosResultados" header="[Despesas] StarkBank - Aprovação de Pagamentos Pendentes" style="margin-bottom:10px;">		    		    
                 <p:dataTable id="dtContratos" var="pagamento" value="#{contratoCobrancaMB.pagamentosStarkBankPendentes}" selection="" emptyMessage="" sortBy="#{pagamento.dataPagamento}" sortOrder="descending"
   		         reflow="true"
   		         rows="10"
                 paginator="true"
                 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                 currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records"
                 rowsPerPageTemplate="10,50,100"
                 rowStyleClass= "#{contratoCobrancaMB.getComparaValorDespesaPagto(pagamento.contasPagar.valor, pagamento.valor) eq true ? 'linhaRosa' : null} ">  
                 	<p:column style="width:16px">
			            <p:rowToggler />
			        </p:column> 
                 	<p:column style="text-align: center;width:105px;" headerText="Contrato">
			            <h:outputText value="#{pagamento.contasPagar.contrato.numeroContrato}" />
			        </p:column>          
                	<p:column style="text-align: center;width:105px;" headerText="Nome" >
			            <h:outputText value="#{pagamento.nomePagador}" />
			        </p:column>
			        <p:column style="text-align: center;width:105px;" headerText="Despesa" >
			            <h:outputText value="#{pagamento.contasPagar.descricao}" />
			        </p:column>
			        <p:column style="text-align: center;width:105px;" headerText="Forma de Pagamento">
			            <h:outputText value="#{pagamento.formaPagamento}" />
			        </p:column>  
			        <p:column style="text-align: center;" headerText="Data Pagamento" sortBy="#{pagamento.dataPagamento}">
			            <h:outputText value="#{pagamento.dataPagamento}" >			            	
			            	<f:convertDateTime locale="pt_BR"  />
			            	<f:convertDateTime locale="pt_BR" pattern="dd/MM/yyyy"/>
			            </h:outputText>
			        </p:column>		
					<p:column style="text-align: center;" headerText="Valor (R$)"  >
						<p:outputLabel value="#{pagamento.valor}" 
							style="FONT-SIZE: 10pt;"
							converter="bigDecimalConverter" />
					</p:column>   
					<p:rowExpansion>
						<p:panel id="TEDStarkBank" header="TED"
							style="margin-bottom:10px;" rendered="#{pagamento.contasPagar.formaTransferencia eq 'TED'}">
							<h:panelGrid columns="2">
								<p:outputLabel value="Nome:" 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.nomeRecebedor}"/>	
		
								<p:outputLabel value="CPF/CNPJ: " 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.documento}"/>
		
								<p:outputLabel value="Banco: " 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.banco}"/>
		
								<p:outputLabel value="Agência: " 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.agencia}"/>
		
								<p:outputLabel value="C/C: " 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.conta}"/>	
								
								<p:outputLabel value="Tipo da Conta: " 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.tipoContaBancaria}"/>									
							</h:panelGrid>												
						</p:panel>
						<p:panel id="PIXStarkBank" header="PIX"
							style="margin-bottom:10px;" rendered="#{pagamento.contasPagar.formaTransferencia eq 'Pix' || pagamento.contasPagar.formaTransferencia eq 'PIX' }">
							<h:panelGrid columns="2">
								<p:outputLabel value="Nome:" 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.nomeRecebedor}"/>	
		
								<p:outputLabel value="CPF/CNPJ: " 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.documento}"/>
		
								<p:outputLabel value="Banco: " 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.banco}"/>
		
								<p:outputLabel value="Agência: " 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.agencia}"/>
		
								<p:outputLabel value="C/C: " 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.conta}"/>	
								
								<p:outputLabel value="Tipo da Conta: " 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.tipoContaBancaria}"/>		
								
								<p:outputLabel value="Chave Pix: " 
									style="width:250px;" styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.pix}"/>
								
								<p:outputLabel value="ISPB: " 
									style="width:250px;" styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.ispb}"/>														
							</h:panelGrid>												
						</p:panel>
						<p:panel id="BoletoStarkBank" header="Boleto"
							style="margin-bottom:10px;" rendered="#{pagamento.contasPagar.formaTransferencia eq 'Boleto'}">
							<h:panelGrid columns="2">		
								<p:outputLabel value="CPF/CNPJ Recebedor boleto: " 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.documento}"/>
		
								<p:outputLabel value="Linha Digitável: " 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.linhaBoleto}"/>												
							</h:panelGrid>																						
						</p:panel>
			        </p:rowExpansion>      
			        <p:column styleClass="colunaResponsiva">	
			       		<shiro:hasAnyRoles name="ROOT">  
				        	<p:commandButton action="#{contratoCobrancaMB.processaPagamentoStarkBank()}" ajax="false" icon="ui-icon-print" value="Aprovar Pagamento" title="Aprovar Pagamento">
				        		<f:setPropertyActionListener target="#{contratoCobrancaMB.objetoBaixaPagamentoStarkBank}" value="#{pagamento}" />
			                </p:commandButton>
			                <p:spacer width="10" height="10"/>		
			                <p:commandButton oncomplete="PF('baixasStarkBankdlg').show();"
											icon="ui-icon-video" title="Reprovar Pagamento" value="Reprovar Pagamento"
											update=":starkBankBaixasForm">
								<f:setPropertyActionListener target="#{contratoCobrancaMB.objetoBaixaPagamentoStarkBank}" value="#{pagamento}" />								
							</p:commandButton>
			                <p:spacer width="10" height="10"/>	
			            </shiro:hasAnyRoles>               
		            </p:column>			        		               		        			        			           			 		
				</p:dataTable>
			</p:panel>
			<p:panel id="ConsultaContratosResultadosCartaSplit" header="[Carta Split] StarkBank - Aprovação de Pagamentos Pendentes" style="margin-bottom:10px;">		    		    
                 <p:dataTable id="dtContratosCartaSplit" var="pagamento" value="#{contratoCobrancaMB.pagamentosStarkBankPendentesCartaSplit}" selection="" emptyMessage="" sortBy="#{pagamento.dataPagamento}" sortOrder="descending"
	   		         reflow="true"
	   		         rows="10"
	                 paginator="true"
	                 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
	                 currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records"
	                 rowsPerPageTemplate="10,50,100"
	                 rowStyleClass= "#{contratoCobrancaMB.getComparaValorDespesaPagto(pagamento.contasPagar.valor, pagamento.valor) eq true ? 'linhaRosa' : null} "> 
                 	<p:column style="width:16px">
			            <p:rowToggler />
			        </p:column> 
                 	<p:column style="text-align: center;width:105px;" headerText="Contrato">
			            <h:outputText value="#{pagamento.contasPagar.contrato.numeroContrato}" />
			        </p:column>          
                	<p:column style="text-align: center;width:105px;" headerText="Nome" >
			            <h:outputText value="#{pagamento.nomePagador}" />
			        </p:column>
			        <p:column style="text-align: center;width:105px;" headerText="Despesa" >
			            <h:outputText value="#{pagamento.contasPagar.descricao}" />
			        </p:column>
			        <p:column style="text-align: center;width:105px;" headerText="Forma de Pagamento">
			            <h:outputText value="#{pagamento.formaPagamento}" />
			        </p:column>  
			        <p:column style="text-align: center;" headerText="Data Pagamento" sortBy="#{pagamento.dataPagamento}">
			            <h:outputText value="#{pagamento.dataPagamento}" >			            	
			            	<f:convertDateTime locale="pt_BR"  />
			            	<f:convertDateTime locale="pt_BR" pattern="dd/MM/yyyy"/>
			            </h:outputText>
			        </p:column>		
			        <p:column style="text-align: center;" headerText="Valor (R$)"  >
						<p:outputLabel value="#{pagamento.contasPagar.valor}" 
							style="FONT-SIZE: 10pt;"
							converter="bigDecimalConverter" />
					</p:column>   
					<p:column style="text-align: center;" headerText="Valor Pagamento (R$)"  >
						<p:outputLabel value="#{pagamento.valor}" 
							style="FONT-SIZE: 10pt;"
							converter="bigDecimalConverter" />
					</p:column>  
					<p:rowExpansion>
						<p:panel id="BoletoStarkBankCartaSplit" header="Boleto"
							style="margin-bottom:10px;" rendered="#{pagamento.contasPagar.formaTransferencia eq 'Boleto'}">
							<h:panelGrid columns="2">
								<p:outputLabel value="Recebedor:" 
									styleClass="labelBold"/>
								<p:outputLabel value=" "/>	
		
								<p:outputLabel value="CPF/CNPJ Recebedor boleto: " 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.contasPagar.numeroDocumentoPagadorStarkBank}"/>
		
								<p:outputLabel value="Linha Digitável: " 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.contasPagar.linhaDigitavelStarkBank}"/>												
							</h:panelGrid>												
						</p:panel>
						<p:panel id="PixStarkBankCartaSplit" header="PIX"
							style="margin-bottom:10px;" rendered="#{pagamento.contasPagar.formaTransferencia eq 'PIX' or pagamento.contasPagar.formaTransferencia eq 'Pix'}">
							<h:panelGrid columns="2">
								<p:outputLabel value="Chave PIX:" 
									styleClass="labelBold"/> 
								<p:outputLabel value="#{pagamento.contasPagar.pix}"/>	
								
								<p:outputLabel value="Banco:" 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.contasPagar.bancoTed}"/>	
		
								<p:outputLabel value="Banco:" 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.contasPagar.agenciaTed}"/>
								
								<p:outputLabel value="Banco:" 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.contasPagar.contaTed}"/>		
								 
								<p:outputLabel value="Nome: " 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.contasPagar.nomeTed}"/>													
							</h:panelGrid>												
						</p:panel>
						<p:panel id="TedStarkBankCartaSplit" header="TED"
							style="margin-bottom:10px;" rendered="#{pagamento.contasPagar.formaTransferencia eq 'TED' or pagamento.contasPagar.formaTransferencia eq 'ted'}">
							<h:panelGrid columns="2">
								<p:outputLabel value="Banco:" 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.contasPagar.bancoTed}"/>	
		
								<p:outputLabel value="Agência: " 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.contasPagar.agenciaTed}"/>
								
								<p:outputLabel value="Banco:" 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.contasPagar.contaTed}"/>		
								
								<p:outputLabel value="Nome: " 
									styleClass="labelBold"/>
								<p:outputLabel value="#{pagamento.contasPagar.nomeTed}"/>										
							</h:panelGrid>												
						</p:panel>
			        </p:rowExpansion>      
			        <p:column styleClass="colunaResponsiva">	
			       		<shiro:hasAnyRoles name="ROOT">  
				        	<p:commandButton action="#{contratoCobrancaMB.processaPagamentoStarkBank()}" ajax="false" icon="ui-icon-print" value="Aprovar Pagamento" title="Aprovar Pagamento">
				        		<f:setPropertyActionListener target="#{contratoCobrancaMB.objetoBaixaPagamentoStarkBank}" value="#{pagamento}" />
			                </p:commandButton>
			                <p:spacer width="10" height="10"/>		
			                <p:commandButton oncomplete="PF('baixasStarkBankdlg').show();"
											icon="ui-icon-video" title="Reprovar Pagamento" value="Reprovar Pagamento"
											update=":starkBankBaixasForm">
								<f:setPropertyActionListener target="#{contratoCobrancaMB.objetoBaixaPagamentoStarkBank}" value="#{pagamento}" />								
							</p:commandButton>
			                <p:spacer width="10" height="10"/>	
			            </shiro:hasAnyRoles>               
		            </p:column>			        		               		        			        			           			 		
				</p:dataTable>
			</p:panel>
		</h:form>
		<p:dialog header="Reprova Pagamento - #{contratoCobrancaMB.objetoBaixaPagamentoStarkBank.contasPagar.contrato.numeroContrato} - #{contratoCobrancaMB.objetoBaixaPagamentoStarkBank.contasPagar.descricao}" overflow="auto"
			widgetVar="baixasStarkBankdlg" resizable="true" style="FONT-SIZE: 13pt;">
			<h:form id="starkBankBaixasForm">	
				<h:panelGrid columns="1">
					<p:outputLabel value="Comentário: " 
						style="font-size: 20px !important;" styleClass="labelBold"/>
					<h:inputTextarea id="observacaoReprova"
								value="#{contratoCobrancaMB.objetoBaixaPagamentoStarkBank.comentario}"
								rows="10" cols="48" maxlength="3000" onblur=""
								counterTemplate="{0} characters remaining." autoResize="false"
								style="FONT-SIZE: 10pt;width:400px;">
								<p:ajax process="@this" partialSubmit="true" />
					</h:inputTextarea>
				</h:panelGrid>
				
				<div align="center" style="margin-top: 20px;">
					<p:commandButton action="#{contratoCobrancaMB.processaReprovaPagamentoStarkBank()}" ajax="false" icon="ui-icon-print" value="Reprovar Pagamento" title="Reprovar Pagamento" oncomplete="PF('baixasStarkBankdlg').hide();" />
				</div>
			</h:form>
		</p:dialog>
	</ui:define>
</ui:composition>